<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="theme-color" content="#1a1a2e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Kompite - Skill-Based Gaming</title>
  <link rel="stylesheet" href="css/mobile-first.css">
  <style>
    .lobby-header { text-align: center; padding: 32px 16px; }
    .logo { font-size: 48px; font-weight: bold; background: linear-gradient(135deg, #4CAF50, #2196F3); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .tagline { color: #888; margin-top: 8px; }
    .games-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; padding: 16px; }
    .game-card { background: linear-gradient(145deg, #2a2a40, #1a1a2e); border-radius: 16px; padding: 24px; text-align: center; cursor: pointer; transition: transform 0.2s; border: 2px solid rgba(76, 175, 80, 0.3); min-height: 140px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    .game-card:active { transform: scale(0.98); }
    .game-icon { font-size: 48px; margin-bottom: 8px; }
    .game-name { font-size: 16px; font-weight: bold; margin-bottom: 4px; }
    .game-status { font-size: 12px; color: #4CAF50; }
    .user-bar { display: flex; justify-content: space-between; align-items: center; padding: 16px; background: rgba(0, 0, 0, 0.3); border-radius: 12px; margin: 16px; }
    .user-info { display: flex; align-items: center; gap: 12px; }
    .user-avatar { width: 40px; height: 40px; background: linear-gradient(135deg, #4CAF50, #2196F3); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; }
    .footer { text-align: center; padding: 24px; color: #666; font-size: 12px; }
  </style>
</head>
<body>
  <div class="game-container">
    <div class="status-bar">
      <div class="status-item"><span class="connection-indicator connected" id="connectionIndicator"></span><span id="connectionText">Conectado</span></div>
      <div class="status-item"><span>ğŸ“¡</span><span id="latency">--ms</span></div>
    </div>
    <div class="user-bar">
      <div class="user-info">
        <div class="user-avatar" id="userAvatar">ğŸ®</div>
        <div><div id="userName">Jugador</div><div class="trust-score" id="trustScore">Trust: 100</div></div>
      </div>
      <div class="balance-display" id="balanceDisplay">ğŸ’° 0.00 LKC</div>
    </div>
    <div class="lobby-header"><div class="logo">KOMPITE</div><div class="tagline">Skill-Based Gaming â€¢ Win Real Rewards</div></div>
    <div class="games-grid" id="gamesGrid">
      <div class="game-card" data-game="cabezones"><div class="game-icon">âš½</div><div class="game-name">Cabezones</div><div class="game-status">Disponible</div></div>
      <div class="game-card" data-game="air_hockey"><div class="game-icon">ğŸ’</div><div class="game-name">Air Hockey</div><div class="game-status">Disponible</div></div>
      <div class="game-card" data-game="artillery"><div class="game-icon">ğŸ¯</div><div class="game-name">Artillery</div><div class="game-status">Disponible</div></div>
      <div class="game-card" data-game="duel"><div class="game-icon">ğŸ¥Š</div><div class="game-name">Duel</div><div class="game-status">Disponible</div></div>
      <div class="game-card" data-game="snowball"><div class="game-icon">â„ï¸</div><div class="game-name">Snowball</div><div class="game-status">Disponible</div></div>
      <div class="game-card" data-game="memoria"><div class="game-icon">ğŸ§ </div><div class="game-name">Memoria</div><div class="game-status">Disponible</div></div>
    </div>
    <div class="footer"><p>Kompite MVP v1.0.0</p><p>Titular: Yordy JesÃºs Rojas Baldeon</p></div>
  </div>
  <div class="reconnection-overlay" id="reconnectionOverlay" style="display: none;"><div class="reconnection-spinner"></div><div class="reconnection-text">Reconectando...</div><div id="reconnectionCountdown">30s restantes</div></div>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script>
    const KOMPITE_API = 'http://179.7.80.126:8000';
    let socket, userId = localStorage.getItem('userId') || 'player_' + Date.now(), authToken = localStorage.getItem('authToken') || 'token_' + Math.random().toString(36).substr(2, 9);
    function initSocket() {
      socket = io(KOMPITE_API, { auth: { userId, authToken, gameType: 'lobby' }, reconnection: true, reconnectionAttempts: 10, reconnectionDelay: 1000, transports: ['websocket', 'polling'] });
      socket.on('connect', () => { document.getElementById('connectionIndicator').className = 'connection-indicator connected'; document.getElementById('connectionText').textContent = 'Conectado'; document.getElementById('reconnectionOverlay').style.display = 'none'; });
      socket.on('authenticated', (d) => { document.getElementById('balanceDisplay').textContent = 'ğŸ’° ' + d.balance.toFixed(2) + ' LKC'; document.getElementById('trustScore').textContent = 'Trust: ' + d.trustScore; localStorage.setItem('userId', userId); localStorage.setItem('authToken', authToken); });
      socket.on('disconnect', () => { document.getElementById('connectionIndicator').className = 'connection-indicator disconnected'; document.getElementById('connectionText').textContent = 'Desconectado'; document.getElementById('reconnectionOverlay').style.display = 'flex'; });
    }
    function navigateToGame(g) { window.location.href = 'js/games/' + g + '/index.html'; }
    document.querySelectorAll('.game-card').forEach(c => c.addEventListener('click', () => navigateToGame(c.dataset.game)));
    document.addEventListener('DOMContentLoaded', () => { document.getElementById('userName').textContent = userId.substring(0, 15); initSocket(); });
  </script>
</body>
</html>
